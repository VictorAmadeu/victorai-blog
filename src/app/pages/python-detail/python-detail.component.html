<!-- Contenedor principal del detalle.
     *ngIf comprueba que ya tenemos los datos del ejercicio (objeto 'ejercicio').
     Si todavía no hay datos, mostramos la plantilla alternativa 'errorTpl'. -->
<div class="container py-4" *ngIf="ejercicio; else errorTpl">

  <!-- Breadcrumb de navegación: muestra el rastro y permite volver al listado de Python. -->
  <nav aria-label="breadcrumb" class="mb-3">
    <ol class="breadcrumb">
      <!-- routerLink navega a /python (ruta definida en app.routes.ts). -->
      <li class="breadcrumb-item"><a routerLink="/python">Python</a></li>
      <!-- El último elemento del breadcrumb es el título del ejercicio actual. -->
      <li class="breadcrumb-item active">{{ ejercicio.titulo }}</li>
    </ol>
  </nav>

  <!-- Cabecera del ejercicio: título grande + descripción breve. -->
  <h1 class="mb-2">{{ ejercicio.titulo }} ✨</h1>
  <p class="text-muted">{{ ejercicio.descripcion }}</p>

  <!-- Aviso mientras se cargan los .py (controlado por la bandera 'cargando'). -->
  <div *ngIf="cargando" class="alert alert-info">Cargando archivos…</div>

  <!-- Mensaje cuando terminó la carga y no hay archivos en el ejercicio. -->
  <div *ngIf="!cargando && archivos.length === 0" class="alert alert-warning">
    Este ejercicio no tiene archivos asociados todavía.
  </div>

  <!-- Recorremos la lista 'archivos' ya construida en el componente TS.
       'trackBy' mejora rendimiento reutilizando DOM cuando solo cambian valores. -->
  <div *ngFor="let f of archivos; trackBy: trackByNombre" class="mb-4">

    <!-- Nombre del archivo mostrado como título (p. ej., main.py). -->
    <h5 class="mb-2">{{ f.nombre }}</h5>

    <!-- ==================== BLOQUE: CÓDIGO ====================
         Usamos ngx-highlightjs:
         - [highlight]="f.codigo" → el texto fuente del archivo .py.
         - language="python"     → resalta con el lenguaje Python.
         - 'pre' añade scroll si el contenido es largo (con overflow-auto).
    -->
    <pre class="overflow-auto rounded border bg-white">
      <code [highlight]="f.codigo" language="python"></code>
    </pre>

    <!-- ==================== BLOQUE: SALIDA ESPERADA ====================
         Solo se pinta si en el JSON viene 'salida' para ese archivo.
         Se muestra como texto plano simulando una terminal.
    -->
    <ng-container *ngIf="f.salida">
      <div class="small text-muted mt-2 mb-1">Salida esperada (ejemplo de terminal)</div>

      <!-- Estilos sencillos: fondo claro, borde y padding para aspecto “consola”.
           'overflow-auto' evita que líneas muy largas desborden el layout. -->
      <pre class="bg-light p-3 rounded border overflow-auto mb-0">
<code>{{ f.salida }}</code>
      </pre>
    </ng-container>

    <!-- Separador visual entre archivos cuando hay más de uno. -->
    <hr class="mt-4" *ngIf="archivos.length > 1">
  </div>
</div>

<!-- ==================== PLANTILLA DE ERROR/CAÍDA ====================
     Se renderiza cuando 'ejercicio' es null/undefined (id inválido o error de carga). -->
<ng-template #errorTpl>
  <div class="container py-4">
    <!-- Si tenemos mensaje en 'error', se muestra; si no, un aviso genérico. -->
    <div class="alert alert-danger" *ngIf="error; else noData">{{ error }}</div>
    <ng-template #noData>
      <div class="alert alert-warning">No hay datos del ejercicio.</div>
    </ng-template>

    <!-- Botón para volver al listado de ejercicios de Python. -->
    <a routerLink="/python" class="btn btn-outline-secondary btn-sm mt-2">← Volver</a>
  </div>
</ng-template>
